# which-key.nvim 使い方ガイド

キーを押すだけで、利用可能なキーマップが自動表示されるプラグインです。

---

## 🎯 基本的な使い方

### ステップ1: リーダーキーを押す

Neovimで（ノーマルモードで）：
```
Space を押す
```

### ステップ2: 少し待つ（300ms）

自動でポップアップが表示されます：

```
┌──────────────────────────────┐
│ g  → +Git                    │
│ h  → +Git Hunk               │
│ t  → +Toggle                 │
│ f  → +File/Find              │
│ b  → +Buffer                 │
│ w  → +Window                 │
└──────────────────────────────┘
```

`+` が付いているのは**グループ**（さらにキーがある）

### ステップ3: さらにキーを押す

例：`h` を押す

```
┌──────────────────────────────┐
│ s  → ステージング            │
│ r  → 変更を戻す              │
│ u  → アンステージング        │
│ p  → プレビュー              │
│ b  → Blame表示               │
│ d  → 差分表示                │
│ S  → ファイル全体ステージ    │
│ R  → ファイル全体を戻す      │
└──────────────────────────────┘
```

### ステップ4: 実行したいキーを押す

例：`s` を押す → ステージング実行

---

## 🔍 実際の使用例

### 例1: Gitでステージングしたい

```
1. Space を押す
2. ポップアップが表示される
3. h を押す（Git Hunk）
4. 次のポップアップが表示される
5. s を押す（ステージング）
6. → Space + h + s が実行される
```

### 例2: LazyGitを開きたい

```
1. Space を押す
2. g を押す（Git）
3. g を押す（LazyGit起動）
4. → Space + g + g が実行される
```

### 例3: キーマップを探す

```
1. Space を押す
2. ポップアップを見ながら探す
3. グループ名（+付き）を見て辿る
```

---

## ⚙️  カスタマイズ

### 表示速度を変更

`which-key.lua` の設定を変更：

```lua
vim.o.timeoutlen = 300  -- 300ms（デフォルト）
vim.o.timeoutlen = 500  -- 500ms（ゆっくり）
vim.o.timeoutlen = 100  -- 100ms（速い）
```

### すぐに表示したい場合

```lua
vim.o.timeoutlen = 0  -- 即座に表示
```

ただし、これだと連続キーが打ちにくくなります。

---

## 📋 現在登録されているグループ

### メイングループ
| グループ | 説明 | 例 |
|---------|------|-----|
| `<Space>g` | Git操作 | LazyGit起動など |
| `<Space>h` | Git Hunk操作 | ステージング、プレビューなど |
| `<Space>t` | Toggle | Blame表示ON/OFFなど |
| `<Space>f` | File/Find | （将来追加予定） |
| `<Space>b` | Buffer | （将来追加予定） |
| `<Space>w` | Window | （将来追加予定） |

### Git操作（<Space>g）
| キー | 動作 |
|------|------|
| `gg` | LazyGit起動 |
| `gf` | ファイル履歴 |

### Git Hunk操作（<Space>h）
| キー | 動作 |
|------|------|
| `hs` | ステージング |
| `hr` | 変更を戻す |
| `hu` | アンステージング |
| `hp` | プレビュー |
| `hb` | Blame表示 |
| `hd` | 差分表示 |
| `hS` | ファイル全体ステージ |
| `hR` | ファイル全体を戻す |

---

## 💡 便利な機能

### 1. ビジュアルモードでも動作

範囲選択してから：
```
Space + h を押す
  ↓
┌──────────────────────────────┐
│ s  → ステージング（範囲）    │
│ r  → 変更を戻す（範囲）      │
└──────────────────────────────┘
```

### 2. 他のプレフィックスでも動作

```
]   → 次の変更箇所へ（gitsignsの]cなど）
[   → 前の変更箇所へ
g   → g系コマンド（gd, grなど）
z   → z系コマンド（折りたたみなど）
```

### 3. キーマップを追加すると自動で表示される

新しいプラグインを追加すると、which-keyが自動で認識して表示します。

---

## 🎓 応用例

### 例1: キーを覚えていなくても使える

```
「ステージングしたいけど、キーマップ忘れた...」
  ↓
Space を押して待つ
  ↓
ポップアップを見ながら操作
```

### 例2: 新しいプラグインを追加したとき

```
新しいプラグインを追加
  ↓
Space を押して確認
  ↓
新しいキーマップが自動で表示される
```

---

## 🔧 トラブルシューティング

### Q: ポップアップが表示されない

A: 以下を確認：
```vim
:checkhealth which-key
```

### Q: 表示が遅い/速い

A: `which-key.lua` の `timeoutlen` を調整

### Q: 表示が邪魔

A: 以下で一時的に無効化：
```vim
:WhichKey disable
```

再度有効化：
```vim
:WhichKey enable
```

---

## 📝 キーマップを追加する方法

新しいキーマップを追加したら、`which-key.lua` に説明を追加すると表示されます。

例：新しいキーマップ `<leader>fn` (ファイル新規作成) を追加

```lua
wk.add({
  { "<leader>f", group = "File/Find" },
  { "<leader>fn", desc = "新規ファイル" },
})
```

---

## 🚀 次のステップ

1. **実際に使ってみる** - `Space` を押して待つ
2. **遅延時間を調整** - 自分に合った速度に
3. **新しいプラグイン追加時** - 自動で表示を確認

---

もうキーマップを覚える必要はありません！
Space を押して待つだけです。
# Test line for gitsigns
fafa
fadfa

